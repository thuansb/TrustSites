const domains = {
  wallet: [
    'exodus.io',
    'myetherwallet.com',
    'luno.com',
    'blocktrail.com',
    'bitgo.com',
    'coin.space',
    'bitlox.com',
    'ledgerwallet.com',
    'lisk.io',
    'wagecan.com',
    'coolbitx.com',
    'gatehub.net',
    'coinvault.io',
    'classicetherwallet.com',
    'copay.io',
    'multibit.org',
    'electrum.org',
    'mycelium.com',
    'uberpay.io',
    'airbitz.co',
    'trezor.io',
    'bitcoinarmory.com',
    'bitaddress.org',
    'jaxx.io',
    'keepkey.com',
    'bither.net',
    'samouraiwallet.com',
  ],
  paymentGateway: [
    'bitpay.com',
    'shopify.com',
    'coinbase.com',
    'blockchain.info',
    'coinsbank.com',
    'coinjar.com',
    'quadrigacx.com',
    'paymium.com',
    'coincorner.com',
    'coingate.com',
    'gocoin.com',
    'bitaps.com',
    'paxful.com',
    'bitcoinpay.com',
    'bitpagos.net',
    'coinify.com',
    'bitpos.me',
    'luno.com',
    'bitstraat.nl',
    'blockonomics.co',
    'cashila.com',
    'coinpip.com',
    'okpay.com',
    'gourl.io',
    'alfacoins.com',
    'spectrocoin.com',
    'rocketr.net',
    'lavapay.com',
    'cubits.com',
    'cryptopay.me',
    'coinsnap.eu',
    'spicepay.com',
    'softtouchpos.com',
    'inpay.pl',
    'coinsimple.com',
    'satoshipay.io',
    'ru.cryptonator.com',
    'braintreepayments.com',
  ],
  cryptoRelated: [
    'supernet.org',
    'augur.net',
    'chronobank.io',
    'runeuro.net',
    'akasha.world',
    'cyber.fund',
    'icorating.com',
    'smithandcrown.com',
    'iconomi.net',
    'icotracker.net',
    'melonport.com',
    'singulardtv.com',
    'dgx.io',
    'wetrust.io',
    'fermat.org',
  ],
  exchanger: [
    'bestbitcoinexchange.io',
    'btc-e.com',
    'cex.io',
    'okcoin.com',
    'huobi.com',
    'btcc.com',
    'lakebtc.com',
    'coinsbank.com',
    'shapeshift.io',
    'coinbase.com',
    'bitsquare.io',
    'localbitcoins.com',
    'bitstamp.net',
    'kraken.com',
    'bitfinex.com',
    'bittrex.com',
    'poloniex.com',
    'xbtce.com',
    'bitmex.com',
    'gdax.com',
    'coincheck.com',
    'taobizu.com',
    'paxful.com',
    'ripple.com',
    'yunbi.com',
    'itbit.com',
    'bitpanda.com',
    'dabtc.com',
    'livecoin.net',
    'hitbtc.com',
    'gemini.com',
    'btc38.com',
    'korbit.co.kr',
    'bitcoin.de',
    'bitso.com',
    'coinmama.com',
    'bitkan.com',
    'bitquick.co',
    'paymium.com',
    'mercatox.com',
    'unocoin.com',
    '247exchange.com',
    'quoine.com',
    'alfacashier.com',
    'luno.com',
    'vaultoro.com',
    'bitbay.net',
    'changelly.com',
    'btcmarkets.net',
    'c-cex.com',
    'btcxindia.com',
    'quadrigacx.com',
    'yobit.net',
    'anycoindirect.eu',
    'bx.in.th',
    'bitcoin.co.id',
    'virwox.com',
    'bit2c.co.il',
    'nairaex.com',
  ],
  plasticCard: [
    'bit.ly',
    'cointelegraph.com',
    'advcash.com',
    'bitpay.com',
    'shakepay.co',
    'xapo.com',
    'anxpro.com',
    'wirexapp.com',
    'coinsbank.com',
    'cryptopay.me',
    'coinomat.com',
    'spectrocoin.com',
    'spectrocard.com',
    'bitstamp.net',
    'wagecan.com',
    'shiftpayments.com',
    'bitwa.la',
    'coinjar.com',
    'xmlgold.eu',
    'moneypolo.com',
    'getonebit.com',
    'satoshitango.com',
    'bladepayments.com',
    'plutus.it',
    'capitalist.net',
    'unichaxnge.me',
    'coinizy.com',
    'entropay.com',
    'uquid.com',
    'wb21.com',
    'bitnovo.com',
    'worldcore.eu',
    'therocktrading.com',
    'epayments.com',
    'gcx.io',
    'cryptobuyer.io',
    'goldmoney.com',
    'payeer.com',
    'uphold.com',
    'alfacashier.com',
    'leupay.eu',
    'altocenter.com',
    'lavapay.com',
    'loadoo.com',
    'loaddebitcard.com',
    'torwallet.com',
  ],
  news: [
    'coindesk.com',
    'cointelegraph.com',
    '99bitcoins.com',
    'news.bitcoin.com',
    'newsbtc.com',
    'bitcoinist.com',
    'themerkle.com',
    'coinjournal.net',
    'steem.io',
    'news.8btc.com',
    'thebitcoinnews.com',
    'coinidol.com',
    'coinfox.info',
    'coinreport.net',
    'crypto-news.net',
    'cryptolife.net',
    'seebitcoin.com',
    'cointrader.org',
  ],
  pools: [
    'bitmakler.com',
    'suprnova.cc',
    'nanopool.org',
    'nicehash.com',
    'zpool.ca',
    'coinmine.pl',
    'etc.ethermine.org',
    'dwarfpool.com',
    'antpool.com',
    'ru.minergate.com',
    'viabtc.com',
    'blockchain.info',
    'bitcoinchain.com',
    'litecoinpool.org',
  ],
  chartsTrading: [
    'bitcoinwisdom.com',
    'bitcoincharts.com',
    'cryptrader.com',
    'coinsbank.com',
    'coinmarketcap.com',
    'data.bitcoinity.org',
    'coincap.io',
    'tradingview.com',
    'cryptocoincharts.info',
    'cryptowat.ch',
    'coindesk.com',
    'dc-charts.com',
    'tradeblock.com',
    'cryptocurrencychart.com',
    'charts.ripple.com',
  ],
  explore: [
    'blockchain.info',
    'ltc.blockr.io',
    'etherscan.io',
    'gastracker.io',
    'dogechain.info',
    'blocktrail.com',
    'live.blockcypher.com',
    'chainz.cryptoid.info',
    'prohashing.com',
    'blockexperts.com',
    'bchain.info',
    'bitinfocharts.com',
    'chainradar.com',
    'bitpay.com',
    'blockscan.com',
    'mintr.org',
    'counterpartychain.io',
    'chain.so',
    'tradeblock.com',
    'feathercoin.com',
    'webbtc.com',
    'coinprism.info',
    'blockexplorer.com',
    'smartbit.com.au',
    'chainflyer.bitflyer.jp',
    'explorer.dash.org',
    'mynxt.info',
    'explorer.lisk.io',
    'explorer.zcha.in',
    'moneroblocks.info',
    'namecha.in',
    'explorer.pascalcoin.org',
    'explorebtcd.info',
    'expanse.tech',
    'explorer.factom.org',
    'digiexplorer.info',
    'gridresearchcorp.com',
    'burstcoin.biz',
  ],
  crowdfunding: [
    'wings.ai',
    'bnktothefuture.com',
    'startcoin.org',
    'wavesplatform.com',
    'bit.co.in',
    'devcoin.org',
    'nxt.org',
    'dcoin.club',
    'heatledger.',
    'cryptojoin.com',
    'icoo.io',
    'funding.webmoney.ru',
    'realityshares.com',
    'itprism.com',
    'drupal.org',
  ],
  peer2Peer: [
    'openbazaar.org',
    'nxt.org',
    'blackhalo.info',
    'syscoin.org',
    'bitbay.market',
    'gli.ph',
    'bitbing.com',
    'slock.it',
    'rexmls.com',
    'velox.re',
  ],
  dataStorage: [
    'storj.io',
    'maidsafe.net',
    'sia.tech',
    'ipfs.io',
    'bitcore.io',
    'matrix.org',
    'ipfs.io',
    'github.com',
    'duniter.org',
    'emercoin.com',
    'soundchain.org',
    'singulardtv.com',
    'bigchaindb.com',
    'alexandria.io',
  ]
}

const trustSites = Object.keys(domains).reduce((a, b) => a.concat(domains[b]), []);

chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
  if (changeInfo.url) {
    const url = new URL(changeInfo.url);
    const trusted = trustSites.find((trustedDomain) => {
      return url.hostname.match(new RegExp('^([\da-z\.-]+\.)?' + trustedDomain.replace('.', '\.') + '$')) != null;
    });
    console.log(trusted);
    const iconPath = trusted ? "green.png" : "red.png";
    chrome.browserAction.setIcon({path: iconPath});
  }
});
